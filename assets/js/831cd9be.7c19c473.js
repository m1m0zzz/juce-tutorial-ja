"use strict";(self.webpackChunkjuce_tutorial_ja=self.webpackChunkjuce_tutorial_ja||[]).push([[8310],{4028:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>d});var a=o(4848),s=o(8453),n=o(3449);o(6378);const r={title:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d7\u30ec\u30fc\u30e4\u30fc\u306e\u69cb\u7bc9",sidebar_position:1},i="\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30aa\u30fc\u30c7\u30a3\u30aa\u30d7\u30ec\u30fc\u30e4\u30fc\u306e\u69cb\u7bc9",c={id:"audio/tutorial_playing_sound_files",title:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d7\u30ec\u30fc\u30e4\u30fc\u306e\u69cb\u7bc9",description:"\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u518d\u751f\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u306f\u3001JUCE\u3067\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u3092\u6271\u3046\u305f\u3081\u306e\u3044\u304f\u3064\u304b\u306e\u91cd\u8981\u306a\u30af\u30e9\u30b9\u304c\u542b\u307e\u308c\u307e\u3059\u3002",source:"@site/docs/audio/tutorial_playing_sound_files.mdx",sourceDirName:"audio",slug:"/audio/tutorial_playing_sound_files",permalink:"/juce-tutorial-ja/audio/tutorial_playing_sound_files",draft:!1,unlisted:!1,editUrl:"https://github.com/m1m0zzz/juce-tutorial-ja/tree/main/docs/audio/tutorial_playing_sound_files.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d7\u30ec\u30fc\u30e4\u30fc\u306e\u69cb\u7bc9",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Audio",permalink:"/juce-tutorial-ja/category/audio"},next:{title:"\u30aa\u30fc\u30c7\u30a3\u30aa\u5165\u529b\u306e\u51e6\u7406",permalink:"/juce-tutorial-ja/audio/tutorial_processing_audio_input"}},l={},d=[{value:"The AudioSource class",id:"the-audiosource-class",level:2},{value:"Audio formats",id:"audio-formats",level:2},{value:"Initialising the interface",id:"initialising-the-interface",level:2},{value:"Other initialisation",id:"other-initialisation",level:2},{value:"Responding to AudioTransportSource changes",id:"responding-to-audiotransportsource-changes",level:2},{value:"Changing states",id:"changing-states",level:2},{value:"Processing the audio",id:"processing-the-audio",level:2},{value:"Opening a file",id:"opening-a-file",level:2},{value:"Playing and stopping the file",id:"playing-and-stopping-the-file",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h1,{id:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30aa\u30fc\u30c7\u30a3\u30aa\u30d7\u30ec\u30fc\u30e4\u30fc\u306e\u69cb\u7bc9",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30aa\u30fc\u30c7\u30a3\u30aa\u30d7\u30ec\u30fc\u30e4\u30fc\u306e\u69cb\u7bc9"}),"\n",(0,a.jsx)(t.p,{children:"\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u3066\u518d\u751f\u3059\u308b\u65b9\u6cd5\u306b\u3064\u3044\u3066\u8aac\u660e\u3057\u307e\u3059\u3002\u3053\u308c\u306b\u306f\u3001JUCE\u3067\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u3092\u6271\u3046\u305f\u3081\u306e\u3044\u304f\u3064\u304b\u306e\u91cd\u8981\u306a\u30af\u30e9\u30b9\u304c\u542b\u307e\u308c\u307e\u3059\u3002"}),"\n",(0,a.jsx)(t.p,{children:"\u30ec\u30d9\u30eb Intermediate"}),"\n",(0,a.jsx)(t.p,{children:"\u30d7\u30e9\u30c3\u30c8\u30d5\u30a9\u30fc\u30e0 Windows, macOS, Linux"}),"\n",(0,a.jsxs)(t.p,{children:["\u30af\u30e9\u30b9\uff1a ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReader",title:"Reads samples from an audio file stream.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30ea\u30fc\u30c0\u30fc"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classFileChooser",title:"Creates a dialog box to choose a file or directory to load or save.",children:"\u30d5\u30a1\u30a4\u30eb\u30c1\u30e5\u30fc\u30b6\u30fc"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classChangeListener",title:"Receives change event callbacks that are sent out by a ChangeBroadcaster.",children:"\u5909\u66f4\u30ea\u30b9\u30ca\u30fc"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classFile",title:"Represents a local file or directory.",children:"\u30d5\u30a1\u30a4\u30eb"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classFileChooser",title:"Creates a dialog box to choose a file or directory to load or save.",children:"\u30d5\u30a1\u30a4\u30eb\u30c1\u30e5\u30fc\u30b6\u30fc"})]}),"\n",(0,a.jsx)(t.h1,{id:"getting-started",children:"Getting started"}),"\n",(0,a.jsxs)(t.p,{children:["Download the demo project for this tutorial here: ",(0,a.jsx)(t.a,{href:"/tutorials/PIPs/PlayingSoundFilesTutorial.zip",children:"\u30d4\u30c3\u30d7"})," | ",(0,a.jsx)(t.a,{href:"/tutorials/ZIPs/PlayingSoundFilesTutorial.zip",children:"\u30b8\u30c3\u30d7"}),". Unzip the project and open the first header file in the Projucer."]}),"\n",(0,a.jsxs)(t.p,{children:["If you need help with this step, see ",(0,a.jsx)(t.a,{href:"../tutorial_new_projucer_project/",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30ebProjucer\u30d1\u30fc\u30c81\uff1aProjucer\u3092\u59cb\u3081\u308b"}),"."]}),"\n",(0,a.jsx)(t.h1,{id:"the-demo-project",children:"The demo project"}),"\n",(0,a.jsx)(t.p,{children:"\u3053\u306e\u30c7\u30e2\u30fb\u30d7\u30ed\u30b8\u30a7\u30af\u30c8\u3067\u306f\u3001\u30b5\u30a6\u30f3\u30c9\u30fb\u30d5\u30a1\u30a4\u30eb\u306e\u518d\u751f\u3092\u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u3059\u308b\u305f\u3081\u306e3\u3064\u306e\u30dc\u30bf\u30f3\u30fb\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30fc\u30b9\u3092\u7d39\u4ecb\u3057\u307e\u3059\u3002\u3064\u306e\u30dc\u30bf\u30f3\u306f"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"\u30e6\u30fc\u30b6\u30fc\u304c\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u629e\u3059\u308b\u305f\u3081\u306e\u30d5\u30a1\u30a4\u30eb\u9078\u629e\u30dc\u30bf\u30f3\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}),"\n",(0,a.jsx)(t.li,{children:"\u30b5\u30a6\u30f3\u30c9\u3092\u518d\u751f\u3059\u308b\u30dc\u30bf\u30f3\u3002"}),"\n",(0,a.jsx)(t.li,{children:"\u97f3\u3092\u6b62\u3081\u308b\u30dc\u30bf\u30f3\u3002"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"\u30a4\u30f3\u30bf\u30fc\u30d5\u30a7\u30a4\u30b9\u306f\u4ee5\u4e0b\u306e\u30b9\u30af\u30ea\u30fc\u30f3\u30b7\u30e7\u30c3\u30c8\u306e\u901a\u308a\uff1a"}),"\n",(0,a.jsx)(n.A,{src:"https://docs.juce.com/master/tutorial_playing_sound_files_screenshot1.png",caption:"A three-button interface to control sound file playback."}),"\n",(0,a.jsx)(t.h1,{id:"helpful-classes",children:"Helpful classes"}),"\n",(0,a.jsx)(t.h2,{id:"the-audiosource-class",children:"The AudioSource class"}),"\n",(0,a.jsxs)(t.p,{children:["While we can generate audio sample-by-sample in the ",(0,a.jsx)(t.code,{children:"getNextAudioBlock()"})," of the Audio Application template, there are some built-in tools for generating and processing audio. These allow us to link together high-level building blocks to form powerful audio applications without having to process each and every sample of audio within our application code (JUCE does this on our behalf). These building blocks are based on the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," class. In fact, if you have followed any of the tutorials based on the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioAppComponent",title:"A base class for writing audio apps that stream from the audio i/o devices.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," class \u2014 for example, ",(0,a.jsx)(t.a,{href:"../tutorial_simple_synth_noise/",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30db\u30ef\u30a4\u30c8\u30ce\u30a4\u30ba\u30fb\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc\u3092\u4f5c\u308b"})," \u2014 then you have been making use of the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," class already. The ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioAppComponent",title:"A base class for writing audio apps that stream from the audio i/o devices.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," class itself inherits from the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," class and, importantly, contains an ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSourcePlayer",title:"Wrapper class to continuously stream audio from an audio source to an AudioIODevice.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9\u30d7\u30ec\u30fc\u30e4"})," object that streams the audio between the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioAppComponent",title:"A base class for writing audio apps that stream from the audio i/o devices.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," and the audio hardware device. We can simply generate the audio samples directly in the ",(0,a.jsx)(t.code,{children:"getNextAudioBlock()"})," function but we can instead chain a number of ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," objects together to form series of processes. We make use of this feature in this tutorial."]}),"\n",(0,a.jsx)(t.h2,{id:"audio-formats",children:"Audio formats"}),"\n",(0,a.jsx)(t.p,{children:"JUCE \u306f\u3001\u591a\u304f\u306e\u5f62\u5f0f\u306e\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u3092\u8aad\u307f\u66f8\u304d\u3059\u308b\u305f\u3081\u306e\u30c4\u30fc\u30eb\u3092\u63d0\u4f9b\u3057\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001\u7279\u306b\u4ee5\u4e0b\u306e\u30af\u30e9\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\uff1a"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"}),": This class contains a list of audio formats (such as WAV, AIFF, Ogg Vorbis, and so on) and can create suitable objects for reading audio data from these formats."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReader",title:"Reads samples from an audio file stream.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30ea\u30fc\u30c0\u30fc"}),": This class handles the low-level file reading operations on the audio file and allows us to read audio in a consistent format (generally this means arrays of ",(0,a.jsx)(t.code,{children:"\u30d5\u30ed\u30fc\u30c8"})," values). When an ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"})," object is asked to open a particular file, it creates instances of this class."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"}),": This is a subclass of the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," class. It can read audio data from an ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReader",title:"Reads samples from an audio file stream.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30ea\u30fc\u30c0\u30fc"})," object and render the audio via its ",(0,a.jsx)(t.code,{children:"getNextAudioBlock()"})," function."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"}),": This class is another subclass of the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," class. It can control the playback of an ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object. This control includes starting and stopping the playback of the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object. It can also perform sample rate conversion and it can buffer audio ahead of time if we wish."]}),"\n"]}),"\n",(0,a.jsx)(t.h1,{id:"putting-it-together",children:"Putting it together"}),"\n",(0,a.jsxs)(t.p,{children:["We will now bring together these classes along with suitable user interface classes to make our sound file playing application. It is useful at this point to think about the various phases \u2014 or ",(0,a.jsx)(t.em,{children:"\u904b\u8f38\u7701"})," \u2014 of playing an audio file. Once the audio file is loaded we can consider these four possible states:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.em,{children:"\u505c\u6b62"}),": Audio playback is stopped and ready to be started."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.em,{children:"\u30b9\u30bf\u30fc\u30c8"}),": Audio playback hasn't yet started but it has been told to start."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.em,{children:"\u30d7\u30ec\u30fc"}),": Audio is playing."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.em,{children:"\u505c\u6b62"}),": Audio is playing but playback has been told to stop, after this it will return to the ",(0,a.jsx)(t.em,{children:"\u505c\u6b62"})," state."]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["To represent these states, we create an ",(0,a.jsx)(t.code,{children:"\u5217\u6319"})," within our ",(0,a.jsx)(t.code,{children:"\u30e1\u30a4\u30f3\u30b3\u30f3\u30c6\u30f3\u30c4\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," class:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-cpp",children:"\u5217\u6319 TransportState\n    {\n        \u505c\u6b62\u4e2d\u3001\n        \u958b\u59cb\u3001\n        \u518d\u751f\u4e2d\u3001\n        \u505c\u6b62\u4e2d\n    };\n"})}),"\n",(0,a.jsx)(t.h2,{id:"initialising-the-interface",children:"Initialising the interface"}),"\n",(0,a.jsxs)(t.p,{children:["In the constructor for our ",(0,a.jsx)(t.code,{children:"\u30e1\u30a4\u30f3\u30b3\u30f3\u30c6\u30f3\u30c4\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," class, we configure the three buttons:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-cpp",children:'MainContentComponent()\n        \u72b6\u614b (\u505c\u6b62)\n    {\n        addAndMakeVisible (&openButton)\uff1b\n        openButton.setButtonText ("Open...")\uff1b\n        openButton.onClick = [this] { openButtonClicked(); }\uff1b\n \n        addAndMakeVisible (&playButton)\uff1b\n        playButton.setButtonText ("Play")\uff1b\n        playButton.onClick = [this] { playButtonClicked(); }\uff1b\n        playButton.setColour (juce::TextButton::buttonColourId, juce::Colours::green)\uff1b\n        playButton.setEnabled (false)\uff1b\n \n        addAndMakeVisible (&stopButton)\uff1b\n        stopButton.setButtonText\uff08"\u505c\u6b62"\uff09\uff1b\n        stopButton.onClick = [this] { stopButtonClicked(); }\uff1b\n        stopButton.setColour (juce::TextButton::buttonColourId, juce::Colours::red)\uff1b\n        stopButton.setEnabled (false)\uff1b\n'})}),"\n",(0,a.jsxs)(t.p,{children:["// Notice in particular that we disable the ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," and ",(0,a.jsx)(t.strong,{children:"\u30b9\u30c8\u30c3\u30d7"})," buttons initially. The ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button is enabled once a valid file is loaded. We can see here that we have assigned a lambda function to the ",(0,a.jsx)(t.a,{href:"classButton.html#a30b76ab312dc7f66e67596ae20540ec2",title:"You can assign a lambda to this callback object to have it called when the button is clicked.",children:"\u30dc\u30bf\u30f3::onClick"})," helper objects for each of these three buttons (see ",(0,a.jsx)(t.a,{href:"../tutorial_listeners_and_broadcasters/",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30ea\u30b9\u30ca\u30fc\u3068\u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30bf\u30fc"}),"). We also initialise our transport state in the constructor's initialiser list."]}),"\n",(0,a.jsx)(t.h2,{id:"other-initialisation",children:"Other initialisation"}),"\n",(0,a.jsxs)(t.p,{children:["In addition to the three ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classTextButton",title:"A button that uses the standard lozenge-shaped background with a line of text on it.",children:"\u30c6\u30ad\u30b9\u30c8\u30dc\u30bf\u30f3"})," objects we have four other members of our ",(0,a.jsx)(t.code,{children:"\u30e1\u30a4\u30f3\u30b3\u30f3\u30c6\u30f3\u30c4\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," class:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-cpp",children:"    juce::AudioFormatManager formatManager;\n    std::unique_ptrreaderSource\uff1b\n    juce::AudioTransportSource transportSource\uff1b\n    TransportState\u72b6\u614b\uff1b\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Here we see the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"}),", ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"}),", and ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," classes mentioned earlier."]}),"\n",(0,a.jsxs)(t.p,{children:["In the ",(0,a.jsx)(t.code,{children:"\u30e1\u30a4\u30f3\u30b3\u30f3\u30c6\u30f3\u30c4\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," constructor we need to initialise the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"})," object to register a list of standard formats [1]:"]}),"\n",(0,a.jsxs)(t.p,{children:["As a minimum this will enable the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"})," object to create readers for the WAV and AIFF formats. Other formats may be available depending on the platform and the options enabled in the ",(0,a.jsx)(t.code,{children:"Juce_Audio_formats"})," module within the Projucer project as shown in the following screenshot:"]}),"\n",(0,a.jsx)(n.A,{src:"https://docs.juce.com/master/tutorial_playing_sound_files_screenshot2.png",caption:"The juce_audio_formats module options showing audio format options."}),"\n",(0,a.jsxs)(t.p,{children:["In the ",(0,a.jsx)(t.code,{children:"\u30e1\u30a4\u30f3\u30b3\u30f3\u30c6\u30f3\u30c4\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," constructor we also add our ",(0,a.jsx)(t.code,{children:"\u30e1\u30a4\u30f3\u30b3\u30f3\u30c6\u30f3\u30c4\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," object as a listener [2] to the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," object so that we can respond to changes in its state (for example, when it stops):"]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["The function name is ",(0,a.jsx)(t.code,{children:"addChangeListener()"})," in this case, rather than simply ",(0,a.jsx)(t.code,{children:"addListener()"})," as it is with many other listener classes in JUCE."]})}),"\n",(0,a.jsx)(t.h2,{id:"responding-to-audiotransportsource-changes",children:"Responding to AudioTransportSource changes"}),"\n",(0,a.jsxs)(t.p,{children:["When changes in the transport are reported, the ",(0,a.jsx)(t.code,{children:"changeListenerCallback()"})," function will be called. This will be called asynchronously on the message thread:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void changeListenerCallback (juce::ChangeBroadcaster* source) override\n    {\n        if (source == &transportSource)\n        {\n            if (transportSource.isPlaying())\n                changeState (Playing)\uff1b\n            \u3055\u3082\u306a\u3051\u308c\u3070\n                changeState (Stopped)\uff1b\n        }\n    }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["You can see that this just calls a member function ",(0,a.jsx)(t.code,{children:"changeState()"}),"."]}),"\n",(0,a.jsx)(t.h2,{id:"changing-states",children:"Changing states"}),"\n",(0,a.jsxs)(t.p,{children:["The changing of the transport state is localised into this single function ",(0,a.jsx)(t.code,{children:"changeState()"}),". This helps keep all of the logic for this functionality in one place. This function updates the ",(0,a.jsx)(t.code,{children:"\u72b6\u614b"})," member and triggers any changes to other objects that need to take place when in this new state."]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["More experienced readers may wish to use the ",(0,a.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/State_pattern",children:"\u72b6\u614b\u8a2d\u8a08\u30d1\u30bf\u30fc\u30f3"})," as an alternative way of structuring this code."]})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void changeState (TransportState newState)\n    {\n        if (state != newState)\n        {\n            state = newState\uff1b\n \n            switch (state)\n            {\n                case Stopped\uff1a                           // [3]\n                    stopButton.setEnabled (false)\uff1b\n                    playButton.setEnabled (true)\uff1b\n                    transportSource.setPosition (0.0)\uff1b\n                    break\uff1b\n \n                case Starting\uff1a                          // [4]\n                    playButton.setEnabled (false)\uff1b\n                    transportSource.start()\uff1b\n                    break\uff1b\n \n                case Playing\uff1a                           // [5]\n                    stopButton.setEnabled (true)\uff1b\n                    break\uff1b\n \n                \u30b1\u30fc\u30b9\u505c\u6b62\uff1a                          // [6]\n                    transportSource.stop()\uff1b\n                    break\uff1b\n            }\n        }\n    }\n"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["[3]: When the transport returns to the ",(0,a.jsx)(t.em,{children:"\u505c\u6b62"})," state it disables the ",(0,a.jsx)(t.strong,{children:"\u30b9\u30c8\u30c3\u30d7"})," button, enables the ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button, and resets the transport position back to the start of the file."]}),"\n",(0,a.jsxs)(t.li,{children:["[4]: The ",(0,a.jsx)(t.em,{children:"\u30b9\u30bf\u30fc\u30c8"})," state is triggered by the user clicking the ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button, this tells the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," object to start playing. At this point we disable the ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button too."]}),"\n",(0,a.jsxs)(t.li,{children:["[5]: The ",(0,a.jsx)(t.em,{children:"\u30d7\u30ec\u30fc"})," state is triggered by the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," object reporting a change via the ",(0,a.jsx)(t.code,{children:"changeListenerCallback()"})," function. Here we enable the ",(0,a.jsx)(t.strong,{children:"\u30b9\u30c8\u30c3\u30d7"})," button."]}),"\n",(0,a.jsxs)(t.li,{children:["[6]: The ",(0,a.jsx)(t.em,{children:"\u505c\u6b62"})," state is triggered by the user clicking the ",(0,a.jsx)(t.strong,{children:"\u30b9\u30c8\u30c3\u30d7"})," button, so we tell the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," object to stop."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"processing-the-audio",children:"Processing the audio"}),"\n",(0,a.jsxs)(t.p,{children:["The audio processing in this demo project is very straightforward: we simply hand off the processing to the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," object by passing it the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/structAudioSourceChannelInfo",title:"Used by AudioSource::getNextAudioBlock().",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9\u30c1\u30e3\u30f3\u30cd\u30eb\u60c5\u5831"})," struct that we have been passed via the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioAppComponent",title:"A base class for writing audio apps that stream from the audio i/o devices.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," class:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void getNextAudioBlock (const juce::AudioSourceChannelInfo& bufferToFill) override\n    {\n        if (readerSource.get() == nullptr)\n        {\n            bufferToFill.clearActiveBufferRegion()\uff1b\n            \u3092\u8fd4\u3057\u307e\u3059\uff1b\n        }\n \n        transportSource.getNextAudioBlock\uff08bufferToFill\uff09\uff1b\n    }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Notice that we check if there is a valid ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object first and simply zero the output if not (using the convenient ",(0,a.jsx)(t.a,{href:"structAudioSourceChannelInfo.html#a6246ca9f1f6ef86dab31fc0eeaacb7a3",title:"Convenient method to clear the buffer if the source is not producing any data.",children:"AudioSourceChannelInfo::clearActiveBufferRegion()"})," function). The ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," member is stored in a std::unique_ptr object because we need to create these objects dynamically based on the user's actions. It also allows us to check for ",(0,a.jsx)(t.code,{children:"\u30cc\u30eb\u30d7\u30c8\u30eb"})," for invalid objects."]}),"\n",(0,a.jsxs)(t.p,{children:["We also need to remember to pass the ",(0,a.jsx)(t.code,{children:"prepareToPlay()"})," callback to any other ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," objects we are using:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void prepareToPlay (int samplesPerBlockExpected, double sampleRate) override\n    {\n        transportSource.prepareToPlay (samplesPerBlockExpected, sampleRate)\uff1b\n    }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["And the ",(0,a.jsx)(t.code,{children:"releaseResources()"})," callback too:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void releaseResources() override\n    {\n        transportSource.releaseResources()\uff1b\n    }\n"})}),"\n",(0,a.jsx)(t.h2,{id:"opening-a-file",children:"Opening a file"}),"\n",(0,a.jsxs)(t.p,{children:["To open a file we pop up a ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classFileChooser",title:"Creates a dialog box to choose a file or directory to load or save.",children:"\u30d5\u30a1\u30a4\u30eb\u30c1\u30e5\u30fc\u30b6\u30fc"})," object in response to the ",(0,a.jsx)(t.strong,{children:"\u30aa\u30fc\u30d7\u30f3..."})," button being clicked:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'    void openButtonClicked()\n    {\n        chooser = std::make_unique ("Select a Wave file to play...",\n                                                       juce::File{},\n                                                       "*.wav");                     // [7]\n        auto chooserFlags = juce::FileBrowserComponent::openMode\n                          | juce::FileBrowserComponent::canSelectFiles;\n \n        chooser->launchAsync (chooserFlags, [this] (const juce::FileChooser& fc)     // [8]\n        {\n            auto file = fc.getResult();\n \n            if (file != juce::File{})                                                // [9]\n            {\n                auto* reader = formatManager.createReaderFor (file);                 // [10]\n \n                if (reader != nullptr)\n                {\n                    auto newSource = std::make_unique(reader, true); // [11].\n                    transportSource.setSource (newSource.get(), 0, nullptr, reader->sampleRate); // [12].\n                    playButton.setEnabled (true); // [13] playButton.reset (newSource.get())\n                    readerSource.reset (newSource.release()); // [14].\n                }\n            }\n        });\n    }\n'})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["[7]: Create the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classFileChooser",title:"Creates a dialog box to choose a file or directory to load or save.",children:"\u30d5\u30a1\u30a4\u30eb\u30c1\u30e5\u30fc\u30b6\u30fc"})," object with a short message and allow the user to select only ",(0,a.jsx)(t.code,{children:".wav"})," files."]}),"\n",(0,a.jsxs)(t.li,{children:["[8]: Pop up the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classFileChooser",title:"Creates a dialog box to choose a file or directory to load or save.",children:"\u30d5\u30a1\u30a4\u30eb\u30c1\u30e5\u30fc\u30b6\u30fc"})," object."]}),"\n",(0,a.jsxs)(t.li,{children:["[9]: If ",(0,a.jsx)(t.code,{children:"\u3082\u3057"})," will succeed if the user actually selects a file (rather than cancelling)"]}),"\n",(0,a.jsxs)(t.li,{children:["[10]: The ",(0,a.jsx)(t.a,{href:"classAudioFormatManager.html#a4eed7ecbb353d3d85154182de5057221",title:"Searches through the known formats to try to create a suitable reader for this file.",children:"AudioFormatManager::createReaderFor()"})," function is used attempt to create a reader for this particular file. This will return the ",(0,a.jsx)(t.code,{children:"\u30cc\u30eb\u30d7\u30c8\u30eb"})," value if it fails (for example the file is not an audio format the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"})," object can handle)."]}),"\n",(0,a.jsxs)(t.li,{children:["[11]: We create a new ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object using the reader we just created. The second argument ",(0,a.jsx)(t.code,{children:"\u771f\u306e"})," indicates that we want the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object to manage the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReader",title:"Reads samples from an audio file stream.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30ea\u30fc\u30c0\u30fc"})," object and delete it when it is no longer needed. We store the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object in a temporary std::unique_ptr object to avoid deleting a previously allocated ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," prematurely on subsequent commands to open a file."]}),"\n",(0,a.jsxs)(t.li,{children:["[12]: The ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object is connected to our ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," object that is being used in our ",(0,a.jsx)(t.code,{children:"getNextAudioBlock()"})," function. In case the sample rate of the file doesn't match the hardware sample rate we pass this in as the fourth argument, which we obtain from the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReader",title:"Reads samples from an audio file stream.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30ea\u30fc\u30c0\u30fc"})," object. See ",(0,a.jsx)(t.a,{href:"#tutorial_playing_sound_files_notes",children:"\u5099\u8003"})," for more information on the second and third arguments. The ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," source will handle any sample rate conversion that is necessary."]}),"\n",(0,a.jsxs)(t.li,{children:["[13]: The ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button is enabled so that the user can click on it."]}),"\n",(0,a.jsxs)(t.li,{children:["[14]: Since the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," should now be using our newly allocated ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object we can safely store the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object in our ",(0,a.jsx)(t.code,{children:"\u30ea\u30fc\u30c0\u30fc\u30bd\u30fc\u30b9"})," member. (As mentioned in ",(0,a.jsx)(t.a,{href:"#tutorial_playing_sound_files_processing_the_audio",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u306e\u51e6\u7406"})," above.) To do this we must transfer ownership from the local ",(0,a.jsx)(t.code,{children:"\u30cb\u30e5\u30fc\u30bd\u30fc\u30b9"})," variable by using std::unique_ptr::release()."]}),"\n"]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["Storing the newly allocated ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object in a temporary std::unique_ptr object has the added benefit of being exception-safe. An exception could be thrown during the function call ",(0,a.jsx)(t.a,{href:"classAudioTransportSource.html#a20a6a91c4505e77207cadef7ddc4dc5c",title:"Sets the reader that is being used as the input source.",children:"AudioTransportSource::setSource()"}),", in which case the std::unique_ptr object will delete the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object that is no longer needed. If a raw pointer had been used at this point to store ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object then there could be a memory leak since the pointer would be left dangling if the exception is thrown."]})}),"\n",(0,a.jsx)(t.h2,{id:"playing-and-stopping-the-file",children:"Playing and stopping the file"}),"\n",(0,a.jsxs)(t.p,{children:["Since we have already set up the code to actually play the file, we need only call our ",(0,a.jsx)(t.code,{children:"changeState()"})," function with the appropriate argument to play the file. When the ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button is clicked, we do the following:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void playButtonClicked()\n    {\n        changeState (Starting)\uff1b\n    }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Stopping the file is similarly straightforward, when the the ",(0,a.jsx)(t.strong,{children:"\u30b9\u30c8\u30c3\u30d7"})," button is clicked:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void stopButtonClicked()\n    {\n        changeState (\u505c\u6b62)\uff1b\n    }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Change the third (",(0,a.jsx)(t.code,{children:"\u30d5\u30a1\u30a4\u30eb\u30d1\u30bf\u30fc\u30f3\u8a31\u53ef"}),") argument when creating the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classFileChooser",title:"Creates a dialog box to choose a file or directory to load or save.",children:"\u30d5\u30a1\u30a4\u30eb\u30c1\u30e5\u30fc\u30b6\u30fc"})," object to allow the application to load AIFF files too. The file patterns can be separated by a semicolon so this should be ",(0,a.jsx)(t.code,{children:'"*.wav;*.aif;*.aiff"'})," to allow for the two common file extensions for this format."]}),"\n",(0,a.jsx)(t.h1,{id:"adding-pause-functionality",children:"Adding pause functionality"}),"\n",(0,a.jsxs)(t.p,{children:["We will now walk through some steps to add a ",(0,a.jsx)(t.em,{children:"\u30dd\u30fc\u30ba"})," functionality to the application. Here we will make the ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button become a ",(0,a.jsx)(t.strong,{children:"\u30dd\u30fc\u30ba"})," button while the file is playing (instead of just disabling it). We will also make the ",(0,a.jsx)(t.strong,{children:"\u30b9\u30c8\u30c3\u30d7"})," button become a ",(0,a.jsx)(t.strong,{children:"\u30bc\u30ed\u306b\u623b\u3059"})," button while the sound file is paused."]}),"\n",(0,a.jsxs)(t.p,{children:["First of all we need to add two states ",(0,a.jsx)(t.em,{children:"\u4e00\u6642\u505c\u6b62"})," and ",(0,a.jsx)(t.em,{children:"\u4f11\u6b62"})," to our ",(0,a.jsx)(t.code,{children:"\u8f38\u9001\u72b6\u614b"})," enum:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"\u5217\u6319 TransportState\n    {\n        \u505c\u6b62\u4e2d\u3001\n        \u958b\u59cb\u3001\n        \u518d\u751f\u4e2d\n        \u4e00\u6642\u505c\u6b62\u3001\n        \u4e00\u6642\u505c\u6b62\u3001\n        \u505c\u6b62\n    };\n"})}),"\n",(0,a.jsxs)(t.p,{children:["Our ",(0,a.jsx)(t.code,{children:"changeState()"})," function needs to handle the two new states and the code for the other states needs to be updated too:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:'void changeState (TransportState newState)\n    {\n        if (state != newState)\n        {\n            state = newState\uff1b\n \n            switch (state)\n            {\n                \u30b1\u30fc\u30b9 Stopped\uff1a\n                    playButton.setButtonText ("Play")\uff1b\n                    stopButton.setButtonText ("Stop")\uff1b\n                    stopButton.setEnabled (false)\uff1b\n                    transportSource.setPosition (0.0)\uff1b\n                    break\uff1b\n \n                case Starting\uff1a\n                    transportSource.start()\uff1b\n                    break\uff1b\n \n                case Playing\uff1a\n                    playButton.setButtonText ("Pause")\uff1b\n                    stopButton.setButtonText ("Stop")\uff1b\n                    stopButton.setEnabled\uff08true\uff09\uff1b\n                    break\uff1b\n \n                case \u4e00\u6642\u505c\u6b62\uff1a\n                    transportSource.stop()\uff1b\n                    break\uff1b\n \n                \u30b1\u30fc\u30b9Paused\uff1a\n                    playButton.setButtonText ("\u518d\u958b")\uff1b\n                    stopButton.setButtonText ("Return to Zero")\uff1b\n                    break\uff1b\n \n                \u30b1\u30fc\u30b9\u505c\u6b62\uff1a\n                    transportSource.stop()\uff1b\n                    break\uff1b\n            }\n        }\n    }\n'})}),"\n",(0,a.jsx)(t.p,{children:"\u30dc\u30bf\u30f3\u3092\u9069\u5207\u306b\u6709\u52b9\u30fb\u7121\u52b9\u306b\u3057\u3001\u305d\u308c\u305e\u308c\u306e\u72b6\u614b\u3067\u30dc\u30bf\u30f3\u306e\u30c6\u30ad\u30b9\u30c8\u3092\u6b63\u3057\u304f\u66f4\u65b0\u3057\u307e\u3059\u3002"}),"\n",(0,a.jsxs)(t.p,{children:["Notice that we actually stop the transport when asked to pause in the ",(0,a.jsx)(t.em,{children:"\u4e00\u6642\u505c\u6b62"})," state. In the ",(0,a.jsx)(t.code,{children:"changeListenerCallback()"})," function, we need to change the logic to move to the correct state depending on whether a pause or stop request was made:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void changeListenerCallback (juce::ChangeBroadcaster* source) override\n    {\n        if (source == &transportSource)\n        {\n            if (transportSource.isPlaying())\n                changeState (Playing)\uff1b\n            else if ((state == Stopping) || (state == Playing))\n                changeState (Stopped)\uff1b\n            else if (\u4e00\u6642\u505c\u6b62 == \u72b6\u614b)\n                changeState (Paused)\uff1b\n        }\n    }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["We need to change the code when the ",(0,a.jsx)(t.strong,{children:"\u30d7\u30ec\u30fc"})," button is clicked:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void playButtonClicked()\n    {\n        if ((\u72b6\u614b == \u505c\u6b62) || (\u72b6\u614b == \u4e00\u6642\u505c\u6b62))\n            changeState (Starting)\uff1b\n        else if (\u72b6\u614b == \u518d\u751f\u4e2d)\n            changeState (\u4e00\u6642\u505c\u6b62)\uff1b\n    }\n"})}),"\n",(0,a.jsxs)(t.p,{children:["And when the ",(0,a.jsx)(t.strong,{children:"\u30b9\u30c8\u30c3\u30d7"})," button is clicked:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{children:"void stopButtonClicked()\n    {\n        if (state == Paused)\n            changeState (\u505c\u6b62)\uff1b\n        \u3055\u3082\u306a\u3051\u308c\u3070\n            changeState (\u505c\u6b62)\uff1b\n    }\n"})}),"\n",(0,a.jsx)(t.p,{children:"\u3053\u308c\u3067\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u3092\u30d3\u30eb\u30c9\u3057\u3066\u5b9f\u884c\u3067\u304d\u308b\u306f\u305a\u3060\u3002"}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["The source code for this modified version of the application can be found in the ",(0,a.jsx)(t.code,{children:"\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u518d\u751f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb_02.h"})," file of the demo project."]})}),"\n",(0,a.jsxs)(t.p,{children:["Add a ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classLabel",title:"A component that displays a text string, and can optionally become a text editor when clicked.",children:"\u30e9\u30d9\u30eb"})," object to the interface that displays the current time position of the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," object. You can use the ",(0,a.jsx)(t.a,{href:"classAudioTransportSource.html#a1984ac3a6eafb12d5312c3eab5615810",title:"Returns the position that the next data block will be read from.",children:"AudioTransportSource::getCurrentPosition()"})," function to obtain this position. You will also need to make the ",(0,a.jsx)(t.code,{children:"\u30e1\u30a4\u30f3\u30b3\u30f3\u30c6\u30f3\u30c4\u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8"})," class inherit from the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classTimer",title:"Makes repeated callbacks to a virtual method at a specified time interval.",children:"\u30bf\u30a4\u30de\u30fc"})," class and perform periodic updates in your ",(0,a.jsx)(t.code,{children:"timerCallback()"})," function to update the label. You could even use the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classRelativeTime",title:"A relative measure of time.",children:"\u76f8\u5bfe\u6642\u9593"})," class to convert the raw time in seconds to a more useful format in minutes, seconds, and milliseconds."]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["The source code for this exercise can be found in the ",(0,a.jsx)(t.code,{children:"\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u518d\u751f\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb_03.h"})," file of the demo project."]})}),"\n",(0,a.jsx)(t.h1,{id:"summary",children:"Summary"}),"\n",(0,a.jsx)(t.p,{children:"\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001\u30b5\u30a6\u30f3\u30c9\u30d5\u30a1\u30a4\u30eb\u306e\u8aad\u307f\u8fbc\u307f\u3068\u518d\u751f\u306b\u3064\u3044\u3066\u7d39\u4ecb\u3057\u307e\u3057\u305f\u3002\u7279\u306b\u3001\u4ee5\u4e0b\u306e\u4e8b\u67c4\u3092\u53d6\u308a\u4e0a\u3052\u307e\u3057\u305f\uff1a"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["Using the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatManager",title:"A class for keeping a list of available audio formats, and for deciding which one to use to open a gi...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30de\u30cd\u30fc\u30b8\u30e3\u30fc"})," class to create ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReader",title:"Reads samples from an audio file stream.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30ea\u30fc\u30c0\u30fc"})," objects for common audio formats."]}),"\n",(0,a.jsxs)(t.li,{children:["Using various ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioSource",title:"Base class for objects that can produce a continuous stream of audio.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30bd\u30fc\u30b9"})," classes to create and connecting them together. In particular:","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," class for reading and playing audio from ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReader",title:"Reads samples from an audio file stream.",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u30ea\u30fc\u30c0\u30fc"})," objects; and"]}),"\n",(0,a.jsxs)(t.li,{children:["the ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioTransportSource",title:"An AudioSource that takes a PositionableAudioSource and allows it to be played, stopped,...",children:"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30c8\u30e9\u30f3\u30b9\u30dd\u30fc\u30c8\u30fb\u30bd\u30fc\u30b9"})," class for controlling the playback of an ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classAudioFormatReaderSource",title:"A type of AudioSource that will read from an AudioFormatReader.",children:"AudioFormatReaderSource"})," object."]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.li,{children:"\u307e\u305f\u3001\u30aa\u30fc\u30c7\u30a3\u30aa\u30d5\u30a1\u30a4\u30eb\u306e\u518d\u751f\u72b6\u614b\u3092\u7ba1\u7406\u3059\u308b\u4e00\u3064\u306e\u65b9\u6cd5\u306b\u3064\u3044\u3066\u3082\u8abf\u3079\u305f\u3002"}),"\n"]}),"\n",(0,a.jsx)(t.h1,{id:"notes",children:"Notes"}),"\n",(0,a.jsxs)(t.p,{children:["The second and third arguments to the ",(0,a.jsx)(t.a,{href:"classAudioTransportSource.html#a20a6a91c4505e77207cadef7ddc4dc5c",title:"Sets the reader that is being used as the input source.",children:"AudioTransportSource::setSource()"})," function allow you to control look ahead buffering on a background thread. The second argument is the buffer size to use and the third argument is a pointer to a ",(0,a.jsx)(t.a,{href:"https://docs.juce.com/master/classTimeSliceThread",title:"A thread that keeps a list of clients, and calls each one in turn, giving them all a chance to run so...",children:"\u30bf\u30a4\u30e0\u30b9\u30e9\u30a4\u30b9\u30b9\u30ec\u30c3\u30c9"})," object, which is used for the background processing. In this example we use a zero buffer size and a ",(0,a.jsx)(t.code,{children:"\u30cc\u30eb\u30d7\u30c8\u30eb"})," value for the thread object, which is the default."]}),"\n",(0,a.jsx)(t.h1,{id:"see-also",children:"See also"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"../tutorial_listeners_and_broadcasters/",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30ea\u30b9\u30ca\u30fc\u3068\u30d6\u30ed\u30fc\u30c9\u30ad\u30e3\u30b9\u30bf\u30fc"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"../tutorial_simple_synth_noise/",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30db\u30ef\u30a4\u30c8\u30ce\u30a4\u30ba\u30fb\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc\u3092\u4f5c\u308b"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"../tutorial_sine_synth/",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30b5\u30a4\u30f3\u6ce2\u30b7\u30f3\u30bb\u30b5\u30a4\u30b6\u30fc\u3092\u4f5c\u308b"})}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.a,{href:"../tutorial_audio_thumbnail/",children:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u30aa\u30fc\u30c7\u30a3\u30aa\u6ce2\u5f62\u3092\u63cf\u304f"})}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},3449:(e,t,o)=>{o.d(t,{A:()=>s});var a=o(4848);function s(e){let{src:t,caption:o,alt:s,width:n,height:r}=e;return(0,a.jsxs)("figure",{children:[(0,a.jsx)("img",{src:t,alt:s||o,width:n,height:r}),(0,a.jsx)("figcaption",{children:(0,a.jsx)("b",{children:o})})]})}},6378:(e,t,o)=>{o.d(t,{A:()=>s});var a=o(4848);function s(e){let{path:t}=e;return(0,a.jsx)("p",{children:(0,a.jsx)("a",{href:"https://docs.juce.com/master/"+t,children:"\ud83d\udcda Source Page"})})}},8453:(e,t,o)=>{o.d(t,{R:()=>r,x:()=>i});var a=o(6540);const s={},n=a.createContext(s);function r(e){const t=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(n.Provider,{value:t},e.children)}}}]);